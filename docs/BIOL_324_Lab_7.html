<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Boraginaceae, Solanaceae, Apiaceae, and mapping in R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BIOL 324 Labs</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Syllabus.html">Syllabus</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Morphological_Terminology.html">Morphological Terminology</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="BIOL_324_Project_1.html">Project 1 (iNaturalist)</a>
    </li>
    <li>
      <a href="LinneanTypification.html">Linnean Typification</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="BIOL_324_Lab_1.html">Lab 1</a>
    </li>
    <li>
      <a href="BIOL_324_Lab_2.html">Lab 2</a>
    </li>
    <li>
      <a href="BIOL_324_Lab_3.html">Lab 3</a>
    </li>
    <li>
      <a href="BIOL_324_Lab_4.html">Lab 4</a>
    </li>
    <li>
      <a href="BIOL_324_Lab_5.html">Lab 5</a>
    </li>
    <li>
      <a href="BIOL_324_Lab_6.html">Lab 6</a>
    </li>
    <li>
      <a href="BIOL_324_Lab_7.html">Lab 7</a>
    </li>
    <li>
      <a href="BIOL_324_Lab_8.html">Lab 8</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Boraginaceae, Solanaceae, Apiaceae, and mapping in R</h1>

</div>


<hr />
<div id="boraginaceae" class="section level1">
<h1>Boraginaceae</h1>
<p><strong>Borage Family</strong></p>
<hr />
<p><strong>1. Herbs (some tropical species are trees or shrubs)</strong><br />
<strong>2. Leaves simple, alternate, commonly hairy, without stipules.</strong><br />
<strong>3. Flowers perfect, usually actinomorphic, usually borne in a scorpioid or helicoid cyme (drepanium). Sepals 5, free or partially fused. Petals 5, fused. Stamens 5, epipetalous. Pistil compound, ovary superior, carpels 2, but deeply lobed, appearing as 4, style gynobasic, placentation basal.</strong><br />
<strong>4. Fruit 4 nutlets.</strong><br />
<strong>5. About 100 genera and 2000 species, widely distributed.</strong></p>
<p>The Boraginaceae is the 17th largest family in B.C., with 51 species and varieties. A few members of the family are cultivated ornamentals.</p>
<hr />
<div id="diagrams" class="section level2">
<h2>Diagrams</h2>
<p><img src="media/diagram_Boraginaceae1.png" style="width:100.0%" /></p>
<p><br></p>
<p><img src="media/diagram_Boraginaceae2.png" style="width:100.0%" /></p>
<p><br></p>
<hr />
</div>
<div id="leaves" class="section level2">
<h2>Leaves</h2>
<p>Boraginaceae does not have super distinctive leaf characteristics - they are typically simple, alternate, and lacking stipules. One good character, however, is that they tend to be covered in stiff (and irritating to touch!) trichomes. These trichomes cover most vegetative parts of the plant, including the stems, leaves, peduncles/petioles, and calyxes.</p>
<p align="center">
<img src="media/Boraginaceae1.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<p align="center">
<img src="media/Boraginaceae2.jpeg" style="width:100.0%" />
</p>
<hr />
</div>
<div id="flowers" class="section level2">
<h2>Flowers</h2>
<p>The flowers and inflorescence structure of Boraginaceae are quite distinctive, and once you get the visual in your mind it should be fairly easy to narrow down to this family. The flowers are usually actinomorphic, with 5 sepals, 5 fused petals, and 5 stamens. In addition, there are often corolla appendages (aka fornix) forming a ring around the throat of the flower. You can see the fornices quite well in the <em>Myositis</em> sp. (Forge-me-nots) below.</p>
<p align="center">
<img src="media/Boraginaceae3.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<p>Here’s another example from <em>Anchusa</em> sp.</p>
<p align="center">
<img src="media/Boraginaceae4.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<p><em>Borago officinalis</em> (Borage) takes the corolla appendages to the next level, forming two fornices on each petal (instead of the single fornix that is usually present). The inner fornix takes the shape of a tower or pedestal, with epipetalous stamens emerging from the inner curve of the fornix. Examine the below pictures (use the family diagrams to help you), and see if you can identify the different parts of the Borage flower.</p>
<p align="center">
<img src="media/Boraginaceae5.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<p align="center">
<img src="media/Boraginaceae6.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<p align="center">
<img src="media/Boraginaceae7.jpeg" style="width:49.0%" /> <img src="media/Boraginaceae8.jpeg" style="width:49.0%" />
</p>
<p></br></p>
<p>Here you can see a close-up of the inner fornix with the stamen attached.</p>
<p align="center">
<img src="media/Boraginaceae9.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<hr />
<p>Another good characteristic for this family is the inflorescence type. Members of the Boraginaceae have helicoid or scorpioid cymes (see the family diagram for cartoons of what these look like). The development of the flowers spatially and temporally tend to give the inflorescence a coiled look, quite like a fern fiddlehead or a scorpion’s tail (hence “scorpioid” cyme). For the purposes of our lab, we won’t be asking you to differentiate between scorpioid vs helicoid cymes, but getting an appreciation for what they look like can help you identify this family in the field (or narrow down to Boraginaceae in a family ID quiz). Here are some examples:</p>
<p align="center">
<img src="media/Boraginaceae10.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<p align="center">
<img src="media/Boraginaceae11.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<p align="center">
<img src="media/Boraginaceae12.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<hr />
</div>
<div id="fruit" class="section level2">
<h2>Fruit</h2>
<p>Similar to the Lamiaceae, members of the Boraginaceae typically form nutlets as their fruit type. They form four nutlets from two carpels, with a gynobasic style attached at the base and emerging from the center of the four nutlets. The nutlets also often have a thickened rim at the base. Here you can see a flower with 3 developed nutlets (the fourth has already fallen out):</p>
<p align="center">
<img src="media/Boraginaceae13.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<p>And here you can see the depressions that the thickened rims of the nutlets made in the receptacle of the flower.</p>
<p align="center">
<img src="media/Boraginaceae14.jpeg" style="width:100.0%" />
</p>
<p></br></p>
<hr />
</div>
<div id="knowledge-check-7.1" class="section level2">
<h2>KNOWLEDGE CHECK 7.1</h2>
<p>Draw a <em>Borago officinalis</em> flower, and make sure to label the following:</p>
<ul>
<li>Sepals</li>
<li>Petals</li>
<li>Fornices</li>
<li>Stamens</li>
<li>Pistil</li>
<li>Trichomes</li>
</ul>
<p></br></p>
<hr />
</div>
</div>
<div id="solanaceae" class="section level1">
<h1>Solanaceae</h1>
<p><strong>Potato or Nightshade Family</strong></p>
<p><strong>1. Herbs, vines, shrubs, or trees.</strong><br />
<strong>2. Leaves simple or occasionally pinnately lobed to compound, alternate, without stipules.</strong><br />
<strong>3. Flowers perfect, actinomorphic or sometimes zygomorphic. Sepals 5, fused. Petals 5, fused. Stamens 2, 4, or usually 5, epipetalous, sometimes with anthers connivent (converging or coming together but not fused). Pistil compound, ovary superior, carpels 2, placentation axile.</strong><br />
<strong>4. Fruit a berry or capsule.</strong><br />
<strong>5. About 85 genera and more than 2200 species, primarily in tropical America.</strong></p>
<p>The Solanaceae is not a significant family in the flora of B. C., but it is one of the most important in agriculture, providing foods and drugs. Important crops include <em>Solanum</em> (potato, eggplant, tomato), <em>Physalis</em> (tomatillo, ground cherry), <em>Capsicum</em> (red, yellow, and green peppers), and <em>Nicotiana</em> (tobacco). Many species produce poisonous alkaloids. Alkaloids from <em>Atropa</em> (deadly nightshade or belladonna), <em>Hyoscyamus</em> (henbane), <em>Datura</em>, <em>Mandragor</em>a (mandrake), and <em>Brunfelsia</em> are used as drugs, hallucinogens, and poisons. <em>Petunia</em> is the most important ornamental member of the Solanaceae in temperate regions.</p>
<hr />
<div id="diagrams-1" class="section level2">
<h2>Diagrams</h2>
<p><img src="media/diagram_Solanaceae1.png" style="width:100.0%" /></p>
<p><br></p>
<p><img src="media/diagram_Solanaceae2.png" style="width:100.0%" /></p>
<p><br></p>
<hr />
</div>
<div id="flowers-1" class="section level2">
<h2>Flowers</h2>
<p>Members of the Solanaceae are characterized by 5 fused sepals and petals, and typically actinomorphic flowers. Corollas tend to be either wheel-shaped (rotate), trumpet-shaped (salverform), or funnel-shaped (funnelform). See if you can identify these different corolla shapes in the flowers below.</p>
<p><br></p>
<p><em>Solanum lycopersicum</em> (tomato)</p>
<p align="center">
<img src="media/Solanaceae1.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p><em>Nicotiana</em> sp. (tobacco)</p>
<p align="center">
<img src="media/Solanaceae2.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p><em>Datura</em> sp.</p>
<p align="center">
<img src="media/Solanaceae3.jpg" style="width:100.0%" />
</p>
<p><br></p>
<hr />
<p>The Solanaceae tend to have 5 epipetalous stamens (but can also have 2 or 4 stamens). Sometimes, the anthers are “connivent” (converging or pressed together but normally not fused) around the style. The anthers also have poricidal dehiscence (do you remember the type of pollination mechanism and previous family we’ve seen this in?).</p>
<p>You can see connivent anthers and poricidal dehiscence (zoom in to see the pores) quite well in the potato (<em>Solanum</em> sp.) flower below.</p>
<p align="center">
<img src="media/Solanaceae4.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<hr />
</div>
<div id="fruit-1" class="section level2">
<h2>Fruit</h2>
<p>Most members of the Solanacae that you are likely to be familiar with have berries as their fruit type. You’ve examined tomato fruit already. Do you remember the placentation type, number of carpels, and number of locules?</p>
<p align="center">
<img src="media/basic_7.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p>Peppers (in the genus <em>Capsicum</em>) are also berries. Most Solanaceae fruit are formed from 2 carpels, but there can be 3 or 4 in <em>Capsicum</em>.</p>
<p align="center">
<img src="media/Solanaceae5.jpg" style="width:60.0%" />
</p>
<p><br></p>
<hr />
</div>
<div id="knowledge-check-7.2" class="section level2">
<h2>KNOWLEDGE CHECK 7.2</h2>
<p>Draw a potato flower, and make sure to include the following labels:</p>
<ul>
<li>Corolla (indicate shape)</li>
<li>Calyx</li>
<li>Stamens</li>
<li>Style</li>
<li>Stigma</li>
</ul>
<p>In addition, draw a cross-section of a bell pepper, and include the following labels:</p>
<ul>
<li>Ovary wall</li>
<li>Carpel walls (how many?)</li>
<li>Seeds</li>
<li>Placenta (placentation type?)</li>
<li>Locules (how many?)</li>
</ul>
<p><br></p>
<hr />
</div>
</div>
<div id="apiaceae---carrot-family" class="section level1">
<h1>Apiaceae - Carrot Family</h1>
<hr />
<p><strong>1. Mostly herbs.</strong><br />
<strong>2. Leaves usually compound, alternate, without stipules, but usually the petiole has a sheathing base.</strong><br />
<strong>3. Flowers usually perfect or andromonoecious (perfect and male on the same plant), radially symmetrical. Sepals 5, usually small and sometimes absent. Petals 5 (0), not fused. Stamens 5, free. Pistil compound, ovary inferior, carpels 2, placentation axile. Inflorescence an umbel.</strong><br />
<strong>4. Fruit a schizocarp.</strong><br />
<strong>5. About 300 genera and 3000 species, mainly in north temperate regions.</strong></p>
<p>The Apiaceae is the 13th largest family in B.C., with 61 taxa occurring in the province. The family is easily recognized by its usually compound leaves, umbellate inflorescence, 5-merous flowers with an inferior ovary, and distinctive fruit, but genera and species are often difficult to identify. Many keys require mature fruits for definite identification. The plants and especially fruits often contain aromatic oils, which are used as flavorings. Many species are edible, but some are deadly poisonous, including the poison hemlock with which Socrates was executed.</p>
<p>Cultivated crops, herbs, and spices include <em>Apium</em> (celery, celeriac), <em>Pastinaca</em> (parsnip), <em>Daucus</em> (carrot), <em>Foeniculum</em> (fennel), <em>Anethum</em> (dill), <em>Cuminum</em> (cumin), <em>Pimpinella</em> (anise), <em>Petroselinum</em> (parsley), <em>Carum</em> (caraway), and <em>Coriandrum</em> (coriander, Chinese parsley, or cilantro).</p>
<hr />
<div id="diagrams-2" class="section level2">
<h2>Diagrams</h2>
<p><img src="media/diagram_Apiaceae1.png" style="width:100.0%" /></p>
<p><br></p>
<p><img src="media/diagram_Apiaceae2.png" style="width:100.0%" /></p>
<p><br></p>
<p><img src="media/diagram_Apiaceae3.png" style="width:100.0%" /></p>
<p><br></p>
<hr />
</div>
<div id="leaves-1" class="section level2">
<h2>Leaves</h2>
<p>Members of the Apiaceae are characterized by having alternate leaves that are compound and rather dissected (think parsley and cilantro…yum!). Sometimes the leaves are dissected to the point of being thread-like linear filaments. In addition, the leaves quite often have a dilated, sheathing petiole (just like celery!). Here are some examples:</p>
<p align="center">
<img src="media/Apiaceae1.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae2.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae3.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p>Can you see the dilated, sheating petiole below?</p>
<p align="center">
<img src="media/Apiaceae4.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<hr />
</div>
<div id="flowers-2" class="section level2">
<h2>Flowers</h2>
<p>Apiaceae flower and inflorescence structure is fairly consistent and unique, which, in combination with the leaf and fruit characteristics, make it easy to identify this family. Within the family, however, it can be quite difficult to identify genera and species because they all look pretty similar. Your typical Apiaceae flower is small, white or yellow, actinomorphic, and with 5 free sepals, petals, and stamens. The ovary is inferior, and the two short styles often have expanded bases forming a disk or cone-shaped structure that the styles sit on (a “stylopodium” - not easy to see in the photos below as the flowers are so small). Here are some photos:</p>
<p align="center">
<img src="media/Apiaceae6.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae5.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<hr />
<p>A more obvious character than the tiny flowers (which usually require some magnification to make out their features) is the inflorescence structure, which is called an “umbel” (the old name for the Apiaceae was the “Umbelliferae”). An umbel has flowers arranged on pedicils of more or less equal length all arising from a central point, similar to the ribs of an umbrella. Umbels can be simple or more often compound, with “rays” emerging from the end of the peduncle and then pedicels emerging centrally from the end of each ray to form “umbellets”. Quite often the umbel will be subtended by bracts at the base (an “involucre”), and if compound, the umbellets will often be subtended by their own bracts (“involucels”). Look at these photos of umbels, and see if you can identify whether each is simple or compound, and whether involucres and involucels are present.</p>
<p align="center">
<img src="media/Apiaceae7.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae8.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae9.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae10.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<hr />
</div>
<div id="fruit-2" class="section level2">
<h2>Fruit</h2>
<p>Apiaceae have very cool looking fruits, especially when examined using some magnification. The fruit are schizocarps (remember these from Malvaceae?) that split into two mericarps. The mericarps remain attached by a slender Y-shaped stalk called a “carpophore” from which they dangle and eventually fall off. The contiguous faces of the mericarps (where they were originally united) is an “imaginary” line called the “commissure”. Each mericarp can have vertical lines called “nerves” and dark splotches (“oil tubes”) in intervals between the nerves. Some schizocarps are even adorned with spiky barbs. Can you identify these different features in pictures below?</p>
<p align="center">
<img src="media/Apiaceae11.jpeg" style="width:49.0%" /> <img src="media/Apiaceae12.jpeg" style="width:49.0%" />
</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae13.jpeg" style="width:100.0%" />
</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae15.jpeg" style="width:49.0%" /> <img src="media/Apiaceae14.jpeg" style="width:49.0%" />
</p>
<p><br></p>
<p>Similar to Brassicaceae fruits, Apiaceae fruits can be compressed in two different ways: “laterally” which results in a short commissure, and “dorsally” which produces a long commissure. Laterally compressed schizocarps tend to have more wide and chunky mericarps, while dorsally compressed schizocarps tend to have flat and thin mericarps. Can you tell which is which from the examples below?</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae12.jpeg" style="width:49.0%" /> <img src="media/Apiaceae11.jpeg" style="width:49.0%" />
</p>
<p><br></p>
<p align="center">
<img src="media/Apiaceae18.jpeg" style="width:49.0%" /> <img src="media/Apiaceae19.jpeg" style="width:49.0%" />
</p>
<p><br></p>
<hr />
</div>
<div id="knowledge-check-7.3" class="section level2">
<h2>KNOWLEDGE CHECK 7.3</h2>
<p>Draw an Apiaceae plant (feel free to use your imagination) and make sure to include the following:</p>
<ul>
<li>Leaf (label all features that are typical of the Apiaceae).</li>
<li>Flowers (draw a zoomed-in flower and label all parts).</li>
<li>Umbellate inflorescence (indicate whether simple or compound, and label all features).</li>
<li>Fully developed schizocarp with mericarps that have split apart (label all features, and indicate the type of compression).</li>
</ul>
<hr />
</div>
</div>
<div id="r-activity-2" class="section level1">
<h1>R Activity 2</h1>
<p><strong>Mapping Species Distributions using R and GBIF</strong></p>
<hr />
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>At its core, plant taxonomy is the science of naming and grouping plants based on their shared traits. Throughout this course we’ve seen how growth habit, morphology, and geographic distribution can provide valuable information about how to classify and define plants. When we consider geographic information, we are asking questions like “do the plants occupy similar or distinct habitats?” and “are the ranges of these plants disjunct or overlapping?”. Depending on the answer to these questions, our decision to group or separate plants (and give them different names) can be changed dramatically. In this R activity, we’ll demonstrate how we can use publicly available occurrence data to create our very own distribution maps for plants and use these maps to compare the geographic ranges of species you’ve found in the field.</p>
<p>   </p>
<!-- ## Pre-lab -->
<!-- Before starting this week's lab you will have: -->
<!-- 1. Completed R Assignment 1 (Lab 6) and the pre-readings assigned there. -->
<!-- 2. Insert GBIF video tutorial here? Or have them do it in unit 1 (note: GBIF intro material lives as comments in Lab 6). -->
<!-- 3. Read Chapter 2 up to [section 2.3.1 in Modern Dive](https://moderndive.com/2-viz.html). Make sure you are able to produce Figures 2.2 and 2.3 on your own (using the code provided in the textbook). If your R is giving errors while trying to make these figures, please reach out to the TAs to fix them &mdash; it won't be possible to finish this lab without the `ggplot2` package working correctly. -->
<!-- 3. Selected your favourite plant group for creating a species distribution map (not sure if we're doing this) -->
<!-- &nbsp; -->
<!-- &nbsp; -->
<!-- --- -->
<!-- #### Outcomes -->
<!-- By the end of this tutorial you will have: <br> -->
<!-- 1. experience manipulating and mapping species distribution data in R, <br> -->
<!-- 2. familiarity with GBIF and the types of data that can be obtained, <br> -->
<!-- 3. More? -->
<!-- &nbsp; -->
<!-- &nbsp; -->
<hr />
</div>
<div id="mapping-species-distributions" class="section level2">
<h2>Mapping Species Distributions</h2>
<p><br></p>
<p>In previous labs we familiarized ourselves with GBIF, R, and RStudio. Today we’ll be running a script that collects, filters, and maps distribution data for five species of “prickly pear” cacti (Opuntioideae: Cactaceae):</p>
<p><em>Opuntia basilaris</em> (Mojave, Colorado, Utah)</p>
<p><em>Opuntia fragilis</em> (Northwestern)</p>
<p><em>Opuntia humifusa</em> (Eastern)</p>
<p><em>Opuntia polyacantha</em> (Great Plains, foothills of Rocky Mtns)</p>
<p><em>Opuntia stricta</em> (Gulf Coast and Caribbean)</p>
<p><br></p>
<p>First let’s install the required packages. If you have an older version of R, you may need to install them individually, e.g. by running <code>install.packages("mapr")</code> and then the next package, and so on. <strong>Once you have successfully installed packages, you typically don’t need to install them again. When running the code in the future, you can skip the <code>install.packages()</code> step and skip to loading your packages using the <code>library()</code> function.</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;mapr&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">install.packages</span>(<span class="st">&quot;spocc&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">install.packages</span>(<span class="st">&quot;taxize&quot;</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</a></code></pre></div>
<p><br></p>
<p>We’ll also install the development version of the package <code>rgbif</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;rgbif&quot;</span>, <span class="dt">repos =</span> <span class="st">&quot;https://dev.ropensci.org&quot;</span>)</a></code></pre></div>
<p><br></p>
<p>These packages are designed for connecting with the GBIF database (<code>rgbif</code>, <code>spocc</code>, <code>taxize</code>), organizing data (<code>tidyverse</code>), and mapping (<code>mapr</code>). Once installed, use the <code>library()</code> function to attach the packages:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(mapr)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">library</span>(spocc)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">library</span>(taxize)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">library</span>(rgbif)</a></code></pre></div>
<p><br></p>
<p>Now let’s get some occurrence data from GBIF!</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">opuntia_wishlist &lt;-</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;Opuntia basilaris Engelm. &amp; J.M.Bigelow&quot;</span>,</a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="st">&quot;Opuntia fragilis (Nutt.) Haw.&quot;</span>,</a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="st">&quot;Opuntia humifusa Raf.&quot;</span>,</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="st">&quot;Opuntia polyacantha Haw.&quot;</span>,</a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="st">&quot;Opuntia stricta (Haw.) Haw.&quot;</span>)</a></code></pre></div>
<p><br></p>
<p>In this first step we’re creating a list of all of the plant species that we’re hoping to get GBIF data for. The <code>&lt;-</code> operator stores the results in an object that we named <code>opuntia_wishlist</code>. By storing the results in an object we can later return to the object and inspect it, subset it, and pipe it to other functions. In the following step we’ll use the <code>occ()</code> function to search GBIF for the species records. The <code>geometry =</code> option allows us to tell GBIF that we only want data from within a certain region. In this case, we’ve drawn a polygon encompassing North America:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">opuntia_metadata &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw">occ</span>(</a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="dt">query =</span> opuntia_wishlist, </a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="dt">from =</span> <span class="st">&#39;gbif&#39;</span>, </a>
<a class="sourceLine" id="cb5-5" title="5">    <span class="dt">limit =</span> <span class="dv">500</span>, </a>
<a class="sourceLine" id="cb5-6" title="6">    <span class="dt">geometry =</span> <span class="st">&#39;POLYGON((-48.4 11.0, -172.9 13.6, -170.8 72.6, -46.4 71.8, -48.4 11.0))&#39;</span>)</a></code></pre></div>
<p><strong>PAUSE AFTER RUNNING THIS CHUNK OF CODE. This <code>occ()</code> function takes some time, as it is downloading 500 occurrences for each of the 5 species in the list, and running more code while it is working may interrupt the download and cause the later steps to fail! You will know it has completed once <code>opuntia_metadata</code> shows up in your environment pane.</strong></p>
<p><br></p>
<p>In this code we’ve created a new object called <code>opuntia_metadata</code>. This object contains occurrence records found by the <code>occ()</code> function, where we specified our taxon ID (contained in <code>opuntia_ids</code>) and told the function that we wanted our data <code>from = gbif</code> (instead of another database) and that we wanted a maximum of <code>500</code> records. Let’s inspect the structure of the <code>opuntia_metadata</code> object:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">str</span>(opuntia_metadata, <span class="dt">max.level=</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## List of 9
##  $ gbif     :List of 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;occdatind&quot;
##  $ bison    :List of 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;occdatind&quot;
##  $ inat     :List of 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;occdatind&quot;
##  $ ebird    :List of 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;occdatind&quot;
##  $ ecoengine:List of 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;occdatind&quot;
##  $ vertnet  :List of 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;occdatind&quot;
##  $ idigbio  :List of 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;occdatind&quot;
##  $ obis     :List of 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;occdatind&quot;
##  $ ala      :List of 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;occdatind&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;occdat&quot;
##  - attr(*, &quot;searched&quot;)= chr &quot;gbif&quot;</code></pre>
<p><br></p>
<p>The output tells us that <code>opuntia_metadata</code> is a <code>List</code> object with 9 named elements. We are specifically interested in the named element <code>$gbif</code>, so we can simplify our object by subsetting:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">opuntia_simple &lt;-<span class="st"> </span>opuntia_metadata<span class="op">$</span>gbif<span class="op">$</span>data</a></code></pre></div>
<p><br></p>
<p>While writing this code, we discovered that the <code>opuntia_metadata</code> object is pretty complex and with lots of layers! The code above says to take the large object <code>opuntia_metadata</code> and select the element named <code>$gbif</code>. Then, within the element <code>$gbif</code>, select the sub-element <code>$data</code>. Within <code>$data</code> there are 5 elements, each one contains the lat-long information for one of our <em>Opuntia</em> species.</p>
<p>Let’s look at the lat-long data for <em>O. basilaris</em>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">opuntia_simple<span class="op">$</span><span class="st">`</span><span class="dt">Opuntia_basilaris_Engelm._&amp;_J.M.Bigelow</span><span class="st">`</span></a></code></pre></div>
<pre><code>## # A tibble: 500 x 73
##    name  longitude latitude issues prov  key   scientificName datasetKey
##    &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;chr&gt;     
##  1 Opun~     -117.     36.9 cdrou~ gbif  2549~ Opuntia basil~ 50c9509d-~
##  2 Opun~     -116.     34.1 cdrou~ gbif  2550~ Opuntia basil~ 50c9509d-~
##  3 Opun~     -117.     36.9 cdrou~ gbif  2550~ Opuntia basil~ 50c9509d-~
##  4 Opun~     -114.     32.2 cdrou~ gbif  2550~ Opuntia basil~ 50c9509d-~
##  5 Opun~     -117.     36.9 cdrou~ gbif  2550~ Opuntia basil~ 50c9509d-~
##  6 Opun~     -116.     33.7 cdrou~ gbif  2550~ Opuntia basil~ 50c9509d-~
##  7 Opun~     -116.     33.7 cdrou~ gbif  2550~ Opuntia basil~ 50c9509d-~
##  8 Opun~     -117.     36.9 cdrou~ gbif  2550~ Opuntia basil~ 50c9509d-~
##  9 Opun~     -116.     33.8 cdrou~ gbif  2550~ Opuntia basil~ 50c9509d-~
## 10 Opun~     -116.     33.8 cdrou~ gbif  2557~ Opuntia basil~ 50c9509d-~
## # ... with 490 more rows, and 65 more variables: publishingOrgKey &lt;chr&gt;,
## #   installationKey &lt;chr&gt;, publishingCountry &lt;chr&gt;, protocol &lt;chr&gt;,
## #   lastCrawled &lt;chr&gt;, lastParsed &lt;chr&gt;, crawlId &lt;int&gt;, basisOfRecord &lt;chr&gt;,
## #   occurrenceStatus &lt;chr&gt;, taxonKey &lt;int&gt;, kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;,
## #   classKey &lt;int&gt;, orderKey &lt;int&gt;, familyKey &lt;int&gt;, genusKey &lt;int&gt;,
## #   speciesKey &lt;int&gt;, acceptedTaxonKey &lt;int&gt;, acceptedScientificName &lt;chr&gt;,
## #   kingdom &lt;chr&gt;, phylum &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;,
## #   species &lt;chr&gt;, genericName &lt;chr&gt;, specificEpithet &lt;chr&gt;, taxonRank &lt;chr&gt;,
## #   taxonomicStatus &lt;chr&gt;, dateIdentified &lt;chr&gt;,
## #   coordinateUncertaintyInMeters &lt;dbl&gt;, stateProvince &lt;chr&gt;, year &lt;int&gt;,
## #   month &lt;int&gt;, day &lt;int&gt;, eventDate &lt;date&gt;, modified &lt;chr&gt;,
## #   lastInterpreted &lt;chr&gt;, references &lt;chr&gt;, license &lt;chr&gt;,
## #   geodeticDatum &lt;chr&gt;, class &lt;chr&gt;, countryCode &lt;chr&gt;, country &lt;chr&gt;,
## #   rightsHolder &lt;chr&gt;, identifier &lt;chr&gt;, `http://unknown.org/nick` &lt;chr&gt;,
## #   verbatimEventDate &lt;chr&gt;, datasetName &lt;chr&gt;, gbifID &lt;chr&gt;,
## #   collectionCode &lt;chr&gt;, verbatimLocality &lt;chr&gt;, occurrenceID &lt;chr&gt;,
## #   taxonID &lt;chr&gt;, recordedBy &lt;chr&gt;, catalogNumber &lt;chr&gt;,
## #   `http://unknown.org/occurrenceDetails` &lt;chr&gt;, institutionCode &lt;chr&gt;,
## #   rights &lt;chr&gt;, eventTime &lt;chr&gt;, identifiedBy &lt;chr&gt;, identificationID &lt;chr&gt;,
## #   occurrenceRemarks &lt;chr&gt;, infraspecificEpithet &lt;chr&gt;,
## #   informationWithheld &lt;chr&gt;</code></pre>
<p><br></p>
<p>The output is pretty big and messy! The output tells us that it’s a <code>tibble</code> (a type of spreadsheet) with 500 rows and 73 columns. Each row is a record of where <em>Opuntia basilaris</em> has been found or collected. Each column is some information associated with that record. While some of the columns are useful (e.g. the latitude and longitude), most columns aren’t needed (we’ll get rid of them later). In the next step, we’ll combine the five separate <code>tibbles</code> into one:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">useful_variables &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>, <span class="st">&quot;basisOfRecord&quot;</span>, <span class="st">&quot;scientificName&quot;</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3">opuntia_combined &lt;-</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">reduce</span>(opuntia_simple, full_join, <span class="dt">by =</span> useful_variables) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="st">  </span><span class="kw">select</span>(useful_variables)</a></code></pre></div>
<p><br></p>
<p>Above, we created an object <code>useful_variables</code> that has the names of the columns we want in our final dataset. In the next step we used <code>reduce()</code> to create one simple, combined dataset with only the columns specified in <code>useful_variables</code>. Everything else was discarded. Whew! This is a lot of organizing.. we’re almost there. Before we get to mapping, we should check our data for synonyms. The <code>unique()</code> function tells us how many unique entries exist within a column:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">unique</span>(opuntia_combined<span class="op">$</span>scientificName)</a></code></pre></div>
<pre><code>##  [1] &quot;Opuntia basilaris Engelm. &amp; J.M.Bigelow&quot;                              
##  [2] &quot;Opuntia basilaris var. basilaris&quot;                                     
##  [3] &quot;Opuntia basilaris var. brachyclada Munz&quot;                              
##  [4] &quot;Opuntia basilaris var. treleasei (J.M.Coult.) Toumey&quot;                 
##  [5] &quot;Opuntia fragilis (Nutt.) Haw.&quot;                                        
##  [6] &quot;Opuntia fragilis var. fragilis&quot;                                       
##  [7] &quot;Opuntia humifusa Raf.&quot;                                                
##  [8] &quot;Opuntia austrina Small&quot;                                               
##  [9] &quot;Opuntia mesacantha Raf.&quot;                                              
## [10] &quot;Opuntia ammophila Small&quot;                                              
## [11] &quot;Opuntia polyacantha var. erinacea (Engelm. &amp; J.M.Bigelow) B.D.Parfitt&quot;
## [12] &quot;Opuntia polyacantha Haw.&quot;                                             
## [13] &quot;Opuntia arenaria Engelm.&quot;                                             
## [14] &quot;Opuntia polyacantha var. polyacantha&quot;                                 
## [15] &quot;Opuntia trichophora (Engelm. &amp; J.M.Bigelow) Britton &amp; Rose&quot;           
## [16] &quot;Opuntia polyacantha var. juniperina (Britton &amp; Rose) L.D.Benson&quot;      
## [17] &quot;Opuntia dillenii (Ker Gawl.) Haw.&quot;                                    
## [18] &quot;Opuntia stricta (Haw.) Haw.&quot;                                          
## [19] &quot;Opuntia tunoidea Gibbes&quot;                                              
## [20] &quot;Opuntia bentonii Griffiths&quot;                                           
## [21] &quot;Opuntia anahuacensis Griffiths&quot;                                       
## [22] &quot;Opuntia stricta subsp. esparzae Scheinvar&quot;                            
## [23] &quot;Opuntia stricta var. dillenii L.D.Benson&quot;                             
## [24] &quot;Opuntia stricta subsp. stricta&quot;</code></pre>
<p><br></p>
<p>Unfortunately, lots of synonyms were included in the results. We’ll make a object containing the names we want to keep, and use the <code>filter()</code> function to get rid of everything else:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># filter out synonyms</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co"># filter out entries outside of North America</span></a>
<a class="sourceLine" id="cb14-3" title="3">opuntia_fil &lt;-</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span>opuntia_combined <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="st">  </span><span class="kw">filter</span>(scientificName <span class="op">==</span><span class="st"> </span>opuntia_wishlist) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="st">  </span><span class="kw">filter</span>(longitude <span class="op">&lt;</span><span class="st"> </span><span class="dv">-58</span> <span class="op">&amp;</span><span class="st"> </span>latitude <span class="op">&gt;</span><span class="st"> </span><span class="fl">18.1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="st">  </span><span class="kw">filter</span>(basisOfRecord <span class="op">==</span><span class="st"> &quot;HUMAN_OBSERVATION&quot;</span>)</a></code></pre></div>
<p><br></p>
<p>We’re ready to map! Pick some colours for your species (you can pick your own <a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/">from here</a>):</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">mycolors &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;#E69F00&quot;</span>, <span class="st">&quot;#56B4E9&quot;</span>,  <span class="st">&quot;#F0E442&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>, <span class="st">&quot;#CC79A7&quot;</span>)</a></code></pre></div>
<p><br></p>
<p>And map using the <code>map_ggplot()</code> function:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">mapr<span class="op">::</span><span class="kw">map_ggplot</span>(opuntia_fil[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">color =</span> mycolors) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">135</span>, <span class="dv">-55</span> ),  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">90</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Distribution of 5 species of Prickly Pear cacti (Opuntia)&quot;</span>)</a></code></pre></div>
<p><img src="BIOL_324_Lab_7_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p><br></p>
<p>Beauty! After all of that hard work, we’ll save the lat-long data object as an .rds file. We’ll use this data again in Lab 10. <strong>You should edit the filepath below to save the file to a directory of your choosing (somewhere you will remember so that you can load the data later). <code>'~/Downloads/filtered_gbif_dataset.rds'</code> will save it to your Downloads folder if you are using a mac, but you will need to alter this code if you are on PC or would like to save it to a different location on your computer.</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">saveRDS</span>(opuntia_fil, <span class="dt">file =</span> <span class="st">&#39;~/Downloads/filtered_gbif_dataset.rds&#39;</span>)</a></code></pre></div>
<p><br></p>
<hr />
<p>   </p>
</div>
<div id="knowledge-check-7.4" class="section level2">
<h2>KNOWLEDGE CHECK 7.4</h2>
<p>Using the above code as a template, choose 5 species from your iNaturalist observations and create your own geographic map! Here are some tips:</p>
<ul>
<li>Copy and paste the above code into your script to make the <em>Opuntia</em> map and make sure everything is working.
<ul>
<li>Run each line of code one at a time, and look out for any error messages that appear. Errors early in the script will likely cause problems later! Patience is a virtue…</li>
</ul></li>
<li>Modify the code to plot 5 of your iNaturalist species instead.
<ul>
<li>To find the correct names for the GBIF database, go to the GBIF website and search your species. Find the main entry for your species and copy the entire name verbatim, including the genus, species, and authority.</li>
<li>Replace the <em>Opuntia</em> species names with your own species.</li>
<li>Replace any objects with <code>Opuntia</code> in the name with your own object names (e.g. <code>opuntia_simple</code>). Try to make it meaningful/descriptive to help yourself remember as you code (<code>opuntia_simple</code> doesn’t make much sense if you’ve got 5 different species, none of which are in the genus <em>Opuntia</em>!!!).</li>
</ul></li>
<li>If you want to get a little spicy, you can pick your own colors <a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/">from here</a> ;-).</li>
<li>Make your own plot title, and include your name in the title.</li>
</ul>
<p><br> <br></p>
<hr />
</div>
</div>
<div id="for-next-week-and-getting-ready-for-project-2" class="section level1">
<h1>For next week, and getting ready for Project 2</h1>
<hr />
<ul>
<li>Lab 8
<ul>
<li>Last chance to measure your <em>Antennaria</em> species from Lab 4 (participation marks).</li>
<li>You will have another Family ID quiz!</li>
</ul></li>
<li>Project 2
<ul>
<li>Project 2 will involve making a phylogeographic map of 5 of your iNaturalist species, and writing a report comparing the geographic ranges and ecological niches of <em>your least and most widespread species</em>.</li>
<li>More details coming soon.</li>
</ul></li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
